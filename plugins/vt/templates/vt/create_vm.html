{% extends "site_base.html" %}
{% load bootstrap_tags %}
{% load i18n %}
{% load crispy_forms_tags %}
{% load staticfiles %}
{% block breadcrumb %}
    <a href="/project/">项目</a><span class="divider">/</span>
	<a href="/project/detail/{{ slice_obj.project.id }}/">项目详情</a><span class="divider">/</span>
	<a href="/slice/detail/{{ slice_obj.id }}/">虚网详情</a><span class="divider">/</span>
        <li class="active">{% trans "create vm" %}</li>
{% endblock %}
{% block body %}
<!--警告框-->
<div id="slicealertModal" class="modal hide fade in" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
    <div class="modal-body" id="slice_alert_info">
      <p class="text-center"></p>
    </div> 
    <div class="modal-footer">
      <button class="btn delete-confirm btn-info" data-dismiss="modal" id="alert_close_sure">确定</button>
    </div>          
</div>

<!-- 拓扑图 -->
<div id="topologyModal" class="modal hide fade in" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
	<div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title">当前已选节点资源</h4>
    </div>
    <div class="modal-body" id="topology_info">
		<div class="row-fluid">
        	<div class="span8">
        		<iframe scrolling="no" id="topologyiframe" width="530" height="305" src="/slice/topology_d3/?slice_id={{slice_obj.id}}&width=560&height=305&top=0" frameborder="0"></iframe>
         	</div>
         </div>  
	</div>                
</div>

<form class="form-wizard" action="" method="post" accept-charset="utf-8">
<fieldset class="">
    <legend>虚拟机信息</legend>
    <table border="0">
	<tr>
		<td width="15%">类型：</td>
		{%for flavor in flavors%}
			<td width="15%">{% trans flavor.name %}</td>
		{%endfor%}
		<!--td width="25%">微型</td><td width="25%">中型</td><td width="25%">大型</td-->
	</tr>
	<tr>
	<td>CPU：</td><td>1核</td><td>2核</td><td>4核</td><td>8核</td>
	</tr>
	<tr>
	<td>内存：</td><td><input type="text" id="vm_mem"/></td>
	</tr>
	<tr>
	<td>磁盘：</td><td></td>
	</tr>
	<tr>
	<td>镜像：</td><td>{{ vm_form.image }} <span name="imageInfo"></span></td>
	</tr>
	<tr>
	<td>宿主机：</td><td>{{ vm_form.server }} <span name="serverInfo"></span></td>
	</tr>
	</table>
	
	{% if slice_obj.get_dhcp %}
        <label class="">
            {{ vm_form.enable_dhcp }} {{vm_form.enable_dhcp.errors}}
                                                    是否启动DHCP
        </label>
    {%endif%}
	<a href="javascript:update_vms_info()">保存</a>
	<hr/>
</fieldset>

<!-- 显示参数的表格 -->
<table id="vms_info_table">
<thead>
	<tr>
		<td width="10%">名称<td>
		<td width="10%">类型<td>
		<td width="10%">CPU<td>
		<td width="10%">内存</td>
		<td width="10%">磁盘</td>
		<td width="20%">镜像</td>
		<td width="10%">宿主机</td>
		<td width="20%">操作</td>
	</tr>
</thead>
<tbody>
</tbody>
</table>
<hr>
    <div class="form-actions">
        <div class="row-fluid">
            <div class="span3"></div>
          {% if from_link == '0' %}
          <div class="span3"><button type="button" class="btn btn-large btn-block btn-info" onclick="document.location='{% url slice_detail sliceid %}'">{% trans "Cancel" %}</button></div>
          {% else %}
          <div class="span3"><button type="button" class="btn btn-large btn-block btn-info" onclick="document.location='{% url vm_list sliceid %}'">{% trans "Cancel" %}</button></div>
          {% endif %}
          <div class="span3"><button type="button" class="btn btn-large btn-block btn-info" onclick="create_vms({{ sliceid }}, 1, {{from_link}})">{% trans "Submit" %}</button></div>
          <div class="span3"></div>
        </div>
    </div>
</form>
{% endblock %}
{% block extra_script %}
<script src="{{ STATIC_URL}}js/icheck/jquery.icheck.min.js"></script>
<script src="{{ STATIC_URL}}js/taffy.js"></script>
<script src="{{ STATIC_URL}}js/own.js"></script>
<script src="{{ STATIC_URL}}js/vm.js"></script>
<script>
	$("#alert_close_sure").on("click", function(){
		window.location.href='/plugins/vt/vm/list/' + {{sliceid}} + '/';
	})
	
</script>
{% endblock %}
