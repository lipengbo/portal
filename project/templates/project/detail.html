{% extends "site_base.html" %}
{% load i18n %}
{% load staticfiles %}
{% load project_tags %}

{% block breadcrumb %}
<li class="active">{% trans "Project Detail" %}</li>
{% endblock %}

{% block body %}
<fieldset class="base_info">
    <legend>{% trans "Basic info" %}<small class="pull-right"><a href="{% url project_edit project.id %}" class="btn btn-success">{% trans "Edit" %}</a> 
    </small></legend>
    <table class="table">
        <thead>
            <tr>
                <th width="71">
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>{% trans "Project Name" %}</td>
                <td>
                    <h3>{{ project.name }}</h3>
                </td>
            </tr>
            <tr>
                <td>{% trans "Project Description" %}</td>
                <td>{{ project.description }}</td>
            </tr>
            <tr>
                <td>
                    {% trans "Creator" %}
                </td>
                <td>
                    {{ project.owner }}
                </td>
            </tr>
            <tr>
                <td>
                    {% trans "Category" %}
                </td>
                <td>
                    <span class="label label-success">{{ project.category }}</span>
                </td>
            </tr>
            <tr>
                <td>
                    {% trans "Selected Islands" %}
                </td>
                <td>
                    {% for island in project.islands.all %}
                        {{ island.name }}
                    {% endfor %}
                <td>
            </tr>
        </tbody>
    </table>
</fieldset>
<fieldset id="name">

    
    <legend>
   {% trans "Members" %}
        <small class="pull-right">
            <a href="" class="btn btn-success">{% trans "View pending members" %}</a>
            <a href="{% url invite_invite project.get_content_type.id project.id %}" class="btn btn-success">{% trans "Invite members" %}</a>
        </small>
    </legend>
</fieldset>
<div class="row-fluid">
    <div class="span12">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>{% trans "No." %}</th>
                    <th>{% trans "Member name" %}</th>
                    <th>{% trans "Company/Organization" %}</th>
                    <th>{% trans "Actions" %}</th>
                </tr>
            </thead>
            <tr>
                {% for membership in project.membership_set.all %}
                    <td>{{ forloop.counter }}</td>
                    <td>{{ membership.user }}</td>
                    <td>{{ membership.user }}</td>
                    <td>
                        {% if not membership.is_owner %}
                        <a href="{% url project_delete_member membership.id  %}" class="btn btn-inverse btn-delete">{% trans "Remove" %}<td>
                        {% endif %}
                {% endfor %}
            </tr>
        </table>
    </div>
</div>
  <div class="row-fluid">
    <div class="span4 offset4"><a href="{% url create_slice project.id %}" class="btn btn-large btn-block btn-info">创建Slice</a></div>
  </div>
  <fieldset>
     <legend>Slice<button type="button" class="pull-right btn btn-link edit" onclick="document.location='/slice/list/{{ project.id }}/'">更多>></button></legend>
     <ul class="thumbnails example-sites">
         {% for slice in project.slice_set.all %}
        <li class="span3 thumbnail">
          <a class="" href="{% url slice_detail slice.id %}" target="_blank">
            <img src="{% static "img/001.png" %}" />
            <table class="table">
                <tbody>
                    <tr>
                        <td width="100">Slice名称：</td>
                        <td>{{ slice.name }}</td>
                    </tr>
                    <tr>
                        <td valign="top">网络节点个数：</td>
                        <td>{{ slice.get_switches.count }}个</td>
                    </tr>
                    <tr>
                        <td valign="top">虚拟机个数：</td>
                        <td>{% resource_num slice.get_island "virtualmachine" %}{{ virtualmachine_num }}个</td>
                    </tr>
                    <tr>
                        <td valign="top">网络节点：</td>
                        <td>
                            {% for switch in  slice.get_switches%}
                                {{ switch.dpid }}
                            {% endfor %}
                        </td>
                    </tr>
                </tbody>
            </table>
          </a>
          <a href="{% url delete_slice slice.id  %}" class="btn btn-small btn-inverse">移除</a>
        </li>
         {% endfor %}
      </ul>
  </fieldset>
{% endblock %}
{% block extra_script %}

<script type="text/javascript" charset="utf-8">
    $('.btn-delete').click(function(){
         var result = confirm("你确定要删除?");
         if (result) {
            return true;
         } else {
            return false;
         }
    });
</script>
{% endblock %}
