{% extends "site_base.html" %}
{% load i18n %}
{% load staticfiles %}
{% load project_tags %}

{% block head_title %}
{% trans "Project Detail" %} [{{ project.name }}]
{% endblock %}
{% block breadcrumb %}
<li class="active">{% trans "Project Detail" %}</li>
{% endblock %}

{% block body %}
<div class="fill_form">
<fieldset>
    <legend><a href="{% url project_edit project.id %}" class="btn btn-info edit">{% trans "Edit" %}</a>{% trans "Basic info" %}</legend>
    <table class="table table-striped table-hover">
       <thead>
            <tr>
                <th width="25%">{% trans "Project Name" %}</th>
                <th width="35%">{% trans "Project Description" %}</th>
                <th width="25%">{% trans "Creator" %}</th>
                <th width="15%">{% trans "Category" %}</th>
            </tr>
        </thead>  
        <tbody>   
               <tr>
                    <td>{{ project.name }}</td>
                    <td>{{ project.description }}</td>
                    <td>{{ project.owner }}</td>
                    <td><span class="label label-success">{{ project.category }}</span></td>
               </tr>    
            <!--    <tr>
                    <td width="71">{% trans "Project Name" %}：</td>
                    <td>
                        {{ project.name }}
                    </td>
                </tr>
                <tr>
                    <td width="71">{% trans "Project Description" %}：</td>
                    <td>{{ project.description }}</td>
                </tr>
                <tr>
                    <td width="71">
                        {% trans "Creator" %}：
                    </td>
                    <td>
                        {{ project.owner }}
                    </td>
                </tr>
                <tr>
                    <td width="71">
                        {% trans "Category" %}：
                    </td>
                    <td>
                        <span class="label label-success">{{ project.category }}</span>
                    </td>
                </tr>
                <tr>
                    <td width="71">
                        {% trans "Selected Islands" %}：
                    </td>
                    <td>
                        {% for island in project.islands.all %}
                            {{ island.name }}
                        {% endfor %}
                    <td>
                </tr>   -->
        </tbody>
    </table>
</fieldset>
<fieldset id="name">   
    <legend>
        <a href="{% url project_applicant project.id  %}" class="btn btn-info edit">{% trans "View pending members" %}</a>
        <a href="{% url project_invite project.id %}" class="btn btn-info edit">{% trans "Invite members" %}</a>
   {% trans "Members" %}
    </legend>
<div class="row-fluid">
    <div class="span12">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th width="20%">{% trans "No." %}</th>
                    <th width="30%">{% trans "Member name" %}</th>
                    <th width="30%">{% trans "Company/Organization" %}</th>
                    <th width="20%">{% trans "Actions" %}</th>
                </tr>
            </thead>
            <tbody>
                {% for membership in project.membership_set.all %}
            <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ membership.user }}</td>
                    <td>{{ membership.user }}</td>
                    <td>
                        {% if not membership.is_owner %}
                        <a href="{% url project_delete_member membership.id  %}" class="btn btn-info btn-delete">{% trans "Remove" %}</a>
                        {% endif %}
                    </td>
            </tr>
                {% endfor %}
            </tbody>
        </table>    
    </div>
</div>
<a class="edit view_more" href="#">More&nbsp;<i class="icon-caret-right"></i></a>
</fieldset>
  <div class="row-fluid sep_div">
    <div class="span12"><a href="{% url create_slice project.id %}" class="btn btn-large btn-block btn-info">创建Slice</a></div>
  </div>
  <fieldset>
      <legend>
          {% if  project.slice_set.count > 4%}
            <button type="button" class="btn btn-link edit" onclick="document.location='/slice/list/{{ project.id }}/'">更多>></button>
          {% endif %}
          Slice
      </legend>        
        <div class="row-fluid">
             <ul class="thumbnails example-sites">
		         {% for slice in project.slice_set.all %}
		         {% if forloop.counter <= 4  %}
		               {% include "slice/_slice.html" %}
		         {%endif%}
		         {% endfor %}
		     </ul>
		     </div>
		     <a class="edit view_more" href="#">More&nbsp;<i class="icon-caret-right"></i></a>
  </fieldset>
  </div>
{% endblock %}
{% block extra_script %}

 <script>
    $(function($) {

        $(".knob").knob({
            change : function (value) {
                //console.log("change : " + value);
            },
            release : function (value) {
                //console.log(this.$.attr('value'));
                console.log("release : " + value);
            },
            cancel : function () {
                console.log("cancel : ", this);
            },
            draw : function () {

                // "tron" case
                if(this.$.data('skin') == 'tron') {

                    var a = this.angle(this.cv)  // Angle
                        , sa = this.startAngle          // Previous start angle
                        , sat = this.startAngle         // Start angle
                        , ea                            // Previous end angle
                        , eat = sat + a                 // End angle
                        , r = 1;

                    this.g.lineWidth = this.lineWidth;

                    this.o.cursor
                        && (sat = eat - 0.3)
                        && (eat = eat + 0.3);

                    if (this.o.displayPrevious) {
                        ea = this.startAngle + this.angle(this.v);
                        this.o.cursor
                            && (sa = ea - 0.3)
                            && (ea = ea + 0.3);
                        this.g.beginPath();
                        this.g.strokeStyle = this.pColor;
                        this.g.arc(this.xy, this.xy, this.radius - this.lineWidth, sa, ea, false);
                        this.g.stroke();
                    }

                    this.g.beginPath();
                    this.g.strokeStyle = r ? this.o.fgColor : this.fgColor ;
                    this.g.arc(this.xy, this.xy, this.radius - this.lineWidth, sat, eat, false);
                    this.g.stroke();

                    this.g.lineWidth = 2;
                    this.g.beginPath();
                    this.g.strokeStyle = this.o.fgColor;
                    this.g.arc( this.xy, this.xy, this.radius - this.lineWidth + 1 + this.lineWidth * 2 / 3, 0, 2 * Math.PI, false);
                    this.g.stroke();
           
                     
                        this.g.strokeStyle ='hsl(120,50%,50%)';//线条颜色：绿色
                        this.g.lineWidth = 1;//设置线宽
                        this.g.beginPath();
                        this.g.moveTo(0,0);
                        this.g.lineTo(100,200);
                        this.g.closePath();//可以把这句注释掉再运行比较下不同
                        this.g.stroke();//画线框
                        this.g.fill();//填充颜色
                    
                    return false;
                }
            }
        });

        // Example of infinite knob, iPod click wheel
        var v, up=0,down=0,i=0
            ,$idir = $("div.idir")
            ,$ival = $("div.ival")
            ,incr = function() { i++; $idir.show().html("+").fadeOut(); $ival.html(i); }
            ,decr = function() { i--; $idir.show().html("-").fadeOut(); $ival.html(i); };
        $("input.infinite").knob(
                            {
                            min : 0
                            , max : 20
                            , stopper : false
                            , change : function () {
                                            if(v > this.cv){
                                                if(up){
                                                    decr();
                                                    up=0;
                                                }else{up=1;down=0;}
                                            } else {
                                                if(v < this.cv){
                                                    if(down){
                                                        incr();
                                                        down=0;
                                                    }else{down=1;up=0;}
                                                }
                                            }
                                            v = this.cv;
                                        }
                            });
    });
     
    $(".circle_bar canvas").each(function(){
        var canvasTitle = $(this).attr("data-text");
        var canvasId = $(this).attr("id");       
        var ctxCanvas = document.getElementById(canvasId);
        var context = ctxCanvas.getContext("2d");  
        context.strokeStyle = "#d3d3d3"; 
        context.lineWidth = 2;  
        context.beginPath();         
        context.moveTo(0,10);  
        context.lineTo(50,10);  
        context.stroke();  
        context.closePath();
        
        context.beginPath();   
        context.fillStyle="#01b6ef";    
        context.arc(50,10,2,Math.PI/2,false);
        context.closePath();
        context.fill();
        
        context.fillStyle="#000000";    
        context.fillText(canvasTitle,55,13);        
    });
      
</script>
<script src="{{ STATIC_URL}}js/own.js"></script>
{% endblock %}
