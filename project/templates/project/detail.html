{% extends extent_html %}
{% load i18n %}
{% load staticfiles %}
{% load project_tags %}

{% block head_title %}
{% trans "Project Detail" %} [{{ project.name }}]
{% endblock %}
{% block breadcrumb %}
<a href="/project/">项目</a><span class="divider">/</span>
<li class="active">{% trans "Project Detail" %}</li>
{% endblock %}

{% block body %}
<div class="fill_form">
<fieldset>
    <legend>
        {%if extent_html == "site_base.html" %}
            {% if user.id == project.owner.id %}
            <a href="{% url project_edit project.id %}" class="btn btn-info edit">{% trans "Edit" %}</a>
            {% endif %}
        {%endif%} 
        {% trans "Basic info" %}
    </legend>
    <table class="table table-striped table-hover">
       <thead>
            <tr>
                <th width="25%">{% trans "Project Name" %}</th>
                <th width="40%">{% trans "Project Description" %}</th>
                <th width="20%">{% trans "Creator" %}</th>
                <th width="15%">{% trans "Category" %}</th>
            </tr>
        </thead>  
        <tbody>   
           <tr>
                <td>{{ project.name }}</td>
                <td>{{ project.description }}</td>
                <td>{{ project.owner }}</td>
                <td><span class="">{{ project.category }}</span></td>
           </tr> 
        </tbody>
    </table>
</fieldset>
<fieldset id="name">   
    <legend>
        {%if extent_html == "site_base.html" %}
            {% if user.id == project.owner.id %}
            <a href="{% url project_applicant project.id  %}" class="btn btn-info edit">{% trans "View pending members" %}</a>
            <a href="{% url project_invite project.id %}" class="btn btn-info edit">{% trans "Invite members" %}</a>
            {% endif %}
        {%endif%}
        {% trans "Members" %}
    </legend>
<div class="row-fluid">
    <div class="span12">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th width="20%">{% trans "No." %}</th>
                    <th width="30%">{% trans "Member name" %}</th>
                    <th width="35%">研究方向</th>
                    <th width="15%">{% trans "Actions" %}</th>
                </tr>
            </thead>
            <tbody>
                {% for membership in project.membership_set.all %}
                {% if forloop.counter <= 4  %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ membership.user }}</td>
                    <td>{{ membership.user.get_profile.realm|default:"未填写" }}</td>
                    <td>
                        {% if  project.owner == user %}
                            {% if  membership.user.id != project.owner.id %}
                            <a href="{% url project_delete_member membership.id  %}" class="btn btn-inverse btn-delete">{% trans "Remove" %}</a>
                            {%else%}
                            <button type="button" onclick="" class="btn btn-inverse btn-delete" disabled>{% trans "Remove" %}</button>
                            {%endif%}
                        {%endif%}
                    </td>
                </tr>
                {%endif%}
                {% endfor %}
            </tbody>
        </table>    
    </div>
</div>
{%if  project.membership_set.count > 4 %}
<a class="edit view_more" href="{% url project_member project.id  %}">More&nbsp;<i class="icon-caret-right"></i></a>
{%endif%}
</fieldset>
    {%if extent_html == "site_base.html" %}
    {% if user|is_membership:project %}
      <div class="row-fluid sep_div">
        <div class="span12"><a href="{% url create_slice project.id %}" class="btn btn-large btn-block btn-info">创建虚网</a></div>
      </div>
    {% endif %}
    {%endif%}
  <fieldset>
      <legend>
          虚网
      </legend>        
        <div class="row-fluid">
             <ul class="thumbnails example-sites">
		         {% for slice in project.get_slices %}
		         {% if forloop.counter <= 2  %}
		               {% include "slice/_slice.html" %}
		         {%endif%}
		         {% endfor %}
		     </ul>
		</div>
		{%if  project.slice_set.count > 2 %}
		<a class="edit view_more" href="/slice/list/{{ project.id }}/">More&nbsp;<i class="icon-caret-right"></i></a>
        {%endif%}
  </fieldset>
  </div>
{% endblock %}
{% block extra_script %}
<script src="{{ STATIC_URL}}js/jquery.knob.js"></script>
<script src="{{ STATIC_URL}}js/slice_list.js"></script>
<script src="{{ STATIC_URL}}js/own.js"></script>
{% endblock %}
