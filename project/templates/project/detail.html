{% extends extent_html %}
{% load i18n %}
{% load staticfiles %}
{% load project_tags %}
{% load common_tags %}

{% block head_title %}
{% trans "Project Detail" %} [{{ project.name }}]
{% endblock %}
{% block breadcrumb %}
<a href="/project/">项目</a><span class="divider">/</span>
<li class="active">{% trans "Project Detail" %}</li>
{% endblock %}

{% block body %}
{% if invitation.actions %}
    <div class="alert alert-success">
        您已经被邀请加入该项目，请选择“拒绝”或者“接受”：
        {% for action in invitation.actions %}
        <a class="btn btn-{{ action.action_level }}" href="{{ action.action_url }}?next={{ request.path|urlencode }}">{{ action.action_title }}</a>
        {% endfor %}
    </div>
{% endif %}
<div class="fill_form">
<fieldset>
    <legend>
        {%if extent_html == "site_base.html" %}
            {% has_perm user 'project.change_project' project %}
            {% if has_perm %}
            <a href="{% url project_edit project.id %}" class="btn btn-info edit">{% trans "Edit" %}</a>
            {% endif %}
        {%endif%} 
        <div class="title_word_bg">
                                        {% trans "Basic info" %}
           <div class="triangle"></div> 
        </div>
    </legend>
    <table class="table table-striped table-hover">
        <thead>
            <tr>
                <th width="25%">{% trans "Project Name" %}</th>
                <th width="25%">{% trans "Project Description" %}</th>
                <th width="25%">{% trans "Creator" %}</th>
                <th width="25%">{% trans "Category" %}</th>
            </tr>
        </thead>
        <tbody>
           <tr>
                <td>{{ project.name }}</td>
                <td>{{ project.description }}</td>
                <td>{{ project.owner }}</td>
                <td><span class="">{{ project.category }}</span></td>
           </tr> 
        </tbody>
    </table>
</fieldset>
<fieldset id="name">
    <legend>
        <!--
        {%if extent_html == "site_base.html" %}
            {% if user.id == project.owner.id %}
            <a href="{% url project_applicant project.id  %}" class="btn btn-info edit">{% trans "View pending members" %}</a>
            <a href="{% url project_invite project.id %}" class="btn btn-info edit">{% trans "Invite members" %}</a>
            {% endif %}
        {%endif%}  -->
        <a href="{% url project_member_manage project.id %}" class="btn btn-info edit">管理</a>
        <div class="title_word_bg">
                                        {% trans "Members" %}
           <div class="triangle"></div> 
        </div>       
    </legend>
<div class="row-fluid">
    <div class="span12">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th width="20%">{% trans "Member name" %}名称</th>
                    <th width="25%">研究方向</th>
                    <th width="25%">Email地址</th>
                    <th width="25%">所属单位</th>
                </tr>
            </thead>
            <tbody>
                {% for membership in project.membership_set.all %}
                {% if forloop.counter <= 4  %}
                <tr>
                    <td>{{ membership.user }}</td>
                    <td>{{ membership.user.get_profile.realm|default:"未填写" }}</td>
                    <td>{{ membership.user.email }}</td>
                    <td>
                        {{ membership.user.get_profile.orgnization|default:"未填写" }}
                    </td>
                </tr>
                {%endif%}
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{%if  project.membership_set.count > 4 %}
<a class="edit view_more" href="{% url project_member project.id  %}">More&nbsp;<i class="icon-caret-right"></i></a>
{%endif%}
</fieldset>
  <fieldset>
      <legend>
          <div class="title_word_bg">
                                            虚网
               <div class="triangle"></div> 
            </div>           
           {%if extent_html == "site_base.html" %}
           {% if user|is_membership:project %}
           <a href="{% url create_slice project.id %}" class="btn btn-info edit">新建</a>
          {% endif %}
          {%endif%}
      </legend>        
        <div class="row-fluid">
             <ul class="thumbnails example-sites">
		         {% for slice in project.get_slices %}
		         {% if forloop.counter <= 2  %}
		               {% include "slice/_slice.html" %}
		         {%endif%}
		         {% endfor %}
		     </ul>
		</div>
		{%if  project.get_slices.count > 2 %}
		<a class="edit view_more" href="/slice/list/{{ project.id }}/0/">More&nbsp;<i class="icon-caret-right"></i></a>
        {%endif%}
  </fieldset>
  </div>
{% endblock %}
{% block extra_script %}
<script src="{{ STATIC_URL}}js/jquery.knob.js"></script>
<script src="{{ STATIC_URL}}js/slice_list.js"></script>
<script src="{{ STATIC_URL}}js/own.js"></script>
{% endblock %}
